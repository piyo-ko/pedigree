<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="pedigree_doc.css" type="text/css">
<base target="_top">
<title>「系図を描いて SVG データにしてみよう」の使い方</title>
</head>
<body>

<div class="toc">
<nav>
<ul>
<li><a href="#top">このページの先頭</a></li>
<li><a href="#outline">概要</a></li>
<li><a href="#menu_1">[個々の人物]</a>
  <ul>
  <li><a href="#menu_1_1">[文字の幅]</a></li>
  <li><a href="#menu_1_2">[人を追加する]</a></li>
  <li><a href="#menu_1_3">[名前を修正する]</a></li>
  <li><a href="#menu_1_4">[矩形の高さを増やす]</a></li>
  <li><a href="#menu_1_5">[注釈の行を追加する] </a></li>
  <li><a href="#menu_1_6">[番号のバッジをつける]</a></li>
  <li><a href="#menu_1_7">[人を見る]</a></li>
  <li><a href="#menu_1_8">[人を削除する]</a></li>
  </ul>
</li>
<li><a href="#menu_2">[横の関係]</a>
  <ul>
  <li><a href="#menu_2_1">[横の関係を追加する]</a></li>
  <li><a href="#menu_2_2">[詳細を指定して横の関係を追加する]</a></li>
  <li><a href="#menu_2_3">[横方向につなぐことの可能な相手の数を増やす]</a></li>
  <li><a href="#menu_2_4">[横の関係を削除する]</a></li>
  </ul>
</li>
<li><a href="#menu_3">[縦の関係]</a>
  <ul>
  <li><a href="#menu_3_1">[縦の関係を追加する]</a></li>
  <li><a href="#menu_3_2">[横線の下に縦線をぶら下げる位置を調整する]</a></li>
  <li><a href="#menu_3_3">[縦の関係を削除する]</a></li>
  </ul>
</li>
<li><a href="#menu_4">[人物の移動]</a>
  <ul>
  <li><a href="#menu_4_1">[人の位置を動かす]</a></li>
  <li><a href="#menu_4_2">[人の位置を揃える]</a></li>
  <li><a href="#menu_4_3">[親または子を基準にして人を動かす]</a></li>
  <li><a href="#menu_4_4">[子孫もまとめて下に移動する]</a></li>
  <li><a href="#menu_4_5">[まとめて右に移動する]</a></li>
  <li><a href="#menu_4_6">[まとめて左に移動する]</a></li>
  </ul>
</li>
<li><a href="#menu_5">[全体]</a>
  <ul>
  <li><a href="#menu_5_1">[全体をずらす]</a></li>
  <li><a href="#menu_5_2">[全体の高さを変える]</a></li>
  <li><a href="#menu_5_3">[全体の幅を変える]</a></li>
  <li><a href="#menu_5_4">[タイトルを変更する]</a></li>
  <li><a href="#menu_5_5">[説明文を変更する]</a></li>
  </ul>
</li>
<li><a href="#menu_6">[出力]</a>
  <ul>
  <li><a href="#menu_6_1">[SVG コードを見る]</a></li>
  <li><a href="#menu_6_2">[現状のファイルをダウンロードする]</a></li>
  <li><a href="#menu_6_3">[作業の各段階のファイルをダウンロードする]</a></li>
  <li><a href="#menu_6_4">[人物一覧を出力する]</a></li>
  <li><a href="#menu_6_5">[系図ビューワをダウンロードする]</a></li>
  </ul>
</li>
<li><a href="#menu_7">[読み取り]</a>
  <ul>
  <li><a href="#menu_7_1">[作成済みのデータを読み込む]</a></li>
  <li><a href="#menu_7_2">[自動保存したデータを読み込む]</a></li>
  </ul>
</li>
<li><a href="#edit">保存済みデータに対する手作業での編集</a>
  <ul>
  <li><a href="#edit_1">系図の SVG ファイル</a></li>
  <li><a href="#edit_2">ビューワの HTML ファイル</a></li>
  <li><a href="#edit_3">SVG 用の CSS ファイル</a></li>
  <li><a href="#edit_4">HTML 用の CSS ファイル</a></li>
  </ul>
</li>
</ul>
</nav>
</div>

<div class="main">
<h1 id="top">「<a href="pedigree.html">系図を描いて SVG データにしてみよう</a>」の使い方</h1>

<p>
多分このページを読まなくても使えますが、とりあえず<a href="#outline">概要</a>をお読みください。他の箇所は必要に応じてお読みください。
</p>

<h2 class="man" id="outline">(0) 概要</h2>
<p>
ページ内には、<em>系図</em>を表示する領域と、<em>ポインタの位置にある人物に関する情報</em>を表示する領域と、<em>メニューボタン</em>を表示する領域と、<em>サブメニュー</em>を表示する領域があります。
行いたい作業の種類をメニューボタンで選択すると、その種類に該当するサブメニューの入力フォームが表示されます。その入力フォームで必要な情報を入力して、少しずつ系図を作っていってください。
</p>

<ul>
<li><em>人物を追加する</em>には、<a href="#menu_1">[個々の人物]</a> - <a href="#menu_1_2">[人を追加する]</a> メニューを使います。</li>
<li>婚姻関係などを表すために<em>人物同士を横線 (横リンク) で結ぶ</em>には、<a href="#menu_2">[横の関係]</a> メニューを使います。</li>
<li>親子関係などを表すために<em>人物同士を縦線 (縦リンク) で結ぶ</em>には、<a href="#menu_3">[縦の関係]</a> メニューを使います。</li>
<li>こうした作業をしているうちに<em>人物を動かしたくなったら</em> <a href="#menu_4">[人物の移動]</a> メニューを使います。</li>
<li><em>系図全体を動かしたり</em>、<em>余白を増減させたり</em>したい場合には、<a href="#menu_5">[全体]</a> メニューを使います。</li>
<li>出来上がった系図または作業途中の系図を<em>保存する</em>には、<a href="#menu_6">[出力]</a> メニューを使います。
<a href="#menu_6">[出力]</a> メニューにはいくつかサブメニューがあり、系図を SVG 形式で保存する以外にも、<em>系図ビューワを構成するファイル一式をダウンロードする</em>などといったことが可能です。</li>
<li><em>作成済みのデータ</em>を <a href="#menu_7">[読み取り]</a> メニューから<em>読み込む</em>ことができます。</li>
<li>系図が巨大化してくるにつれて、<em>操作対象の人物をプルダウンリストから探すのも大変</em>になります。そういう場合、<em>系図上で目的の人物の上にマウスポインタを合わせて</em>みてください。系図のすぐ下の領域に<em>その人物に関する情報 (ID や座標など) が表示されます</em>。ブラウザによっては反応がなかったり遅かったりするので、そういうときは目的の人物の上でマウスポインタを小刻みに揺らしてみてください。プルダウンリストは ID 順になっていて、名前に ID を併記してありますので、ID が分かれば目的の人物をプルダウンリストから探すのも楽になります。</li>
</ul>


<p>
御意見・御感想などは <a href="https://twitter.com/pi__yo__ko">Twitter</a> でお知らせください (どうぞお気軽に)。
</p>

<h2 class="man" id="menu_1">(1) [個々の人物] メニュー</h2>
<p>
<em>人物を追加する</em> には [人を追加する] メニューを使います。
他のメニューは必ずしも必要になるとは限りません。
</p>

<h3 class="man" id="menu_1_1">(1-1) [文字の幅] メニュー</h3>
<p>
<em>人物名</em>を<em>漢字・仮名</em>で書く場合は [幅広モード] を選択し、<em>ラテン文字</em>で書く場合は [幅狭モード] を選択するのがおすすめです。
ここでのモード選択は、人物名や注釈を横書きにする際に文字列が占める幅に影響します。
</p>
<p>
今のところ他の文字体系は想定していないので、本ツール自体が動作するかどうか分かりません。
</p>

<h3 class="man" id="menu_1_2">(1-2) [人を追加する] メニュー</h3>
<p>
</p>

<ul>
<li>追加したい人物の<em>名前</em>を入力します。</li>
<li>名前を<em>縦書き</em>にする場合はチェックボックスをチェックします。</li>
<li>人物を表す矩形に適用するスタイルを選択します。<em>「なし」は灰色、「女性」は橙色、「男性」は緑色</em>です。なお、<a href="#edit_3">手作業で CSS ファイルを書き換える</a>か、<a href="#edit_1">手作業で SVG ファイルを書き換える</a>ことで、この色使いを変えられます。</li>
<li>追加したい人物を<em>どこに配置するか</em>を指定します。ランダムに配置するか、あるいは、既存の人物を基準にして、その左上・真上・右上・左・右・左下・真下・右下のいずれかに配置することができます。</li>
<li>以上の指定が済んだら、「この人を追加する」ボタンをクリックします。</li>
</ul>

<h3 class="man" id="menu_1_3">(1-3) [名前を修正する] メニュー</h3>
<p>
名前を修正したい人物をプルダウンリストから選択し、新しい名前を入力します。
今の名前よりも新しい名前の方が長い場合は、新しい名前に合わせて自動的に矩形が大きくなります。
今の名前よりも新しい名前の方が短い場合は、新しい名前に合わせて矩形を小さくするか、それとも、矩形の大きさをそのままにするかを選べます。
</p>

<h3 class="man" id="menu_1_4">(1-4) [矩形の高さを増やす] メニュー</h3>
<p>
多数の側室がいる皇帝などは、矩形の高さが十分でないと綺麗に作図できません。
そのように多数の相手と横リンクで結ばれる人物の矩形の高さは、このメニューを使って適宜増やしてください。
</p>

<h3 class="man" id="menu_1_5">(1-5) [注釈の行を追加する] メニュー</h3>
<p>
個々の人物に対して<em>任意の注釈 (諡号、廟号、字、別名、生没年、その他何でも構いません)</em> をつけられます。
注釈の色は所定の選択肢の中から選べます。
なお、<a href="#edit_3">手作業で CSS ファイルを書き換える</a>か、<a href="#edit_1">手作業で SVG ファイルを書き換える</a>ことで、この色使いを変えられます。
</p>

<p>
注釈の変更・削除の機能はありません。注釈の変更・削除は、<a href="#edit_1">手作業で SVG ファイルを書き換える</a>ことで行います。
</p>

<h3 class="man" id="menu_1_6">(1-6) [番号のバッジをつける] メニュー</h3>
<p>
<em>兄弟姉妹の順序、一つの王朝における王の即位の順序、ある時点での王位継承順など、何らかの (順序を示す) 数字を表示したい場合</em>に、このメニューを使います。
</p>

<ul>
<li>指定できる番号は 0 から 999 までです。</li>
<li>バッジは円形で、色は所定の選択肢の中から選べます。
なお、<a href="#edit_3">手作業で CSS ファイルを書き換える</a>か、<a href="#edit_1">手作業で SVG ファイルを書き換える</a>ことで、この色使いを変えられます。</li>
<li>矩形の四隅のうちのどこにバッジをつけるかも選べます。
換言すれば、一人に対して四つまでのバッジをつけられます。</li>
</ul>

<p>
順序を示す以外にも、「この人の子孫については後で調べて図に追加しよう。今は保留にして今日の作業は終わろう」といった<em>目印</em>として、人物の右下隅に黒の 0 番のバッジを仮につけておく、などの使い方もできます。
あるいは、入り組んだ系図の場合、同一人物を二箇所に置くことで図がこれ以上複雑にならないようにしたりしますが、「この人とこの人は同一人物ですよ」という目印としてバッジを使ってもよいかもしれませんね。
</p>


<p>
なお、バッジの変更・削除の機能はありません。バッジの変更・削除は、<a href="#edit_1">手作業で SVG ファイルを書き換える</a>ことで行います。
</p>

<h3 class="man" id="menu_1_7">(1-7) [人を見る] メニュー</h3>
<p>
系図中の人物が数百人を越えると、誰がどこに配置されているか分からなくなってきます。
このメニューは、そういった場合に使うメニューです。
<em>プルダウンリストで選択された人物を、系図の領域の中心に表示します</em>。
ただ、プルダウンリストの中から目的の人物を探すのも大変なので、改善の余地が大ですね。
</p>

<h3 class="man" id="menu_1_8">(1-8) [人を削除する] メニュー</h3>
<p>
削除したい人物を選び、削除します。
</p>

<h2 class="man" id="menu_2">(2) [横の関係] メニュー</h2>
<p>
<em>婚姻関係などを表すために人物同士を横の線 (横リンク) で結ぶ</em>とき、[横の関係] メニューを使います。
多くの場合は [横の関係を追加する] メニューだけで用が足ります。
</p>

<h3 class="man" id="menu_2_1">(2-1) [横の関係を追加する] メニュー</h3>
<p>
<em>横線 (横リンク) で結びたい二人</em>をプルダウンリストから選び、<em>線の種類 (一重線か二重線か)</em> を選び、「結ぶ」ボタンをクリックしてください。
必要に応じて二人のうちの一方を自動的に下に移動させることで、二人の間を水平な線で結びます。
</p>
<p>
横線の端点となり得る位置は、デフォルトでは、人物を表す矩形の縦の辺の、上から 1/8、2/8、3/8、4/8、5/8、6/8、7/8 の箇所です。
特に指定がなければ、4/8 の所 (縦の辺の中点) を横線の端点として自動的に選択します。そこが使用済みなら 2/8 の所を選択し、以下、6/8 の所、1/8 の所、7/8 の所、3/8 の所、5/8 の所、という優先順で選択されます。この選択は自動的に行われます。
</p>
<p>
<a href="#edit_1">系図の SVG ファイルを手作業で編集する</a>と、横線 (一重線と二重線のいずれでも) を破線にできます。

</p>

<h3 class="man" id="menu_2_2">(2-2) [詳細を指定して横の関係を追加する] メニュー</h3>
<p>
<em>横線の端点の位置を自分で指定したい場合</em>にこのメニューを使います。
多くの側室がいる皇帝について作図したい場合などに便利です。
</p>
<p>
具体的には、左側の人物を選び、その人物の矩形の右辺上の位置 (横線の端点としたい位置) を選び、右側の人物を選び、その人物の矩形の左辺上の位置 (横線の端点としたい位置) を選び、線の種類を選び、「結ぶ」ボタンをクリックしてください。
必要に応じて二人のうちの一方を自動的に下に移動させることで、二人の間を水平な線で結びます。
</p>

<h3 class="man" id="menu_2_3">(2-3) [横方向につなぐことの可能な相手の数を増やす] メニュー</h3>
<p>
デフォルトでも左右 7 人ずつと横線で結べる設定になっていますが、<em>多くの側室がいる皇帝について作図したい場合など</em>は、それでも足りなくなることがあったりします。
そうした場合にこのメニューを使います。
対象人物を選び、左辺または右辺を選び、「増やす」ボタンをクリックすると、その人物の矩形のその辺につなげられる横線の数を増やせます。
</p>

<p>
<em>縦の辺につなげられる横線の数は、2<sup>n</sup> &minus; 1 本です (n &ge; 3)</em>。
つまり、7、15、31、63……本です。
一辺に 15 人だの 31 人だのを繋ぐ必要が生じることは滅多にないとは思いますが、たとえば、「つなげられる横線の数を 15 まで増やしておき、2/16、5/16、8/16、11/16、14/16 の 5 箇所に横線をつなぐ」といった使い方も可能です。2/8、3/8、4/8、5/8、6/8 の 5 箇所に横線をつなぐよりも横線同士の間隔を広くとれるので、やや見栄えが良くなります。
</p>

<h3 class="man" id="menu_2_4">(2-4) [横の関係を削除する] メニュー</h3>
<p>
削除したい横線を選び、削除します。
</p>

<h2 class="man" id="menu_3">(3) [縦の関係] メニュー</h2>
<p>
<em>親子関係などを表すために人物同士を縦線 (縦リンク) で結ぶ</em>とき、[縦の関係] メニューを使います。
多くの場合は [縦の関係を追加する] メニューだけで用が足ります。
</p>

<h3 class="man" id="menu_3_1">(3-1) [縦の関係を追加する] メニュー</h3>
<p>
<em>一人の親から一人の子への縦線</em> (実線または破線) を追加できます。
また、<em>既に横線で繋がれた二人の親から一人の子への縦線</em> (実線または破線) も追加できます。
</p>

<p>
たとえば、実の親子を実線で表し、養子を破線で表す、などと線の種類を使い分けるとよいかもしれません。
あるいは、何代か省略して祖先と子孫を結ぶときに破線を使う、といったことも考えられます。
</p>

<p>
個々の人物の矩形の上辺または下辺に新たな縦線を繋ぐ場合、その辺にまだ何も縦線が繋がれていなければ、その辺の中央に新たな縦線を繋ぎます。
また、新たな縦線が、その辺の中央に既に繋がれている縦線と同じ線種の場合も、その辺の中央に新たな縦線を繋ぎます。
それ以外の場合は、その辺の左または右から 1/4 の位置に、新たな縦線を繋ぎます。
</p>

<h3 class="man" id="menu_3_2">(3-2) [横線の下に縦線をぶら下げる位置を調整する] メニュー</h3>
<p>
横線で繋がれた二人の親から一人の子への縦線は、デフォルトでは、横線の中央からぶら下がっています。
しかし、巨大な系図を作成する場合などには、横線の下に縦線をぶら下げる位置を調整したいことがあります。
このメニューはそういうときのためのものです。
</p>

<h3 class="man" id="menu_3_3">(3-3) [縦の関係を削除する] メニュー</h3>
<p>
削除したい縦線を選び、削除します。 
</p>

<h2 class="man" id="menu_4">(4) [人物の移動] メニュー</h2>
<p>
色々な動かし方のサブメニューがあります。
</p>
<p>
なお、<em>やり直し (undo) 機能はない</em>ので、動かしてみて「失敗した」と思った場合は、<em>一旦、<a href="#menu_6_3">[作業の各段階のファイルをダウンロードする] メニュー</a>で一つ前の段階のデータを保存し、保存した SVG ファイルを <a href="#menu_7_1">[作成済みのデータを読み込む] メニュー</a>から読み込んで、作業を再開してください</em>。
動かし方によっては、単純に逆向きの動きをすることで元に戻せることもありますが、複数人を連動させた場合、一回の動きで元に戻せる動かし方が存在しないことが多々あります。
</p>

<h3 class="man" id="menu_4_1">(4-1) [人の位置を動かす] メニュー</h3>
<p>
動かしたい人物と動かす方向とを選び、動かす量を指定してください。
縦書きの場合、84 px 単位で横に動かすと綺麗に並びます。
</p>

<h3 class="man" id="menu_4_2">(4-2) [人の位置を揃える] メニュー</h3>
<p>
位置の基準にする人物と、整列の仕方と、動かしたい人物を選んでください。
</p>

<h3 class="man" id="menu_4_3">(4-3) [親または子を基準にして人を動かす] メニュー</h3>
<p>
選んだ人物を、その人物の親からの縦線がまっすぐになるように左右に動かせます。
逆に、選んだ人物を、その人物の矩形の下辺につながっている子 (たち) の中央に位置するように、左右に動かすこともできます。
</p>

<h3 class="man" id="menu_4_4">(4-4) [子孫もまとめて下に移動する] メニュー</h3>
<p>
選んだ人物とその子孫をまとめて下に移動します。
もちろん、下に動かす対象の人物と横線で繋がった人物 (とその子孫) も、連動して下に移動します。
移動量は指定できます。
</p>

<h3 class="man" id="menu_4_5">(4-5) [まとめて右に移動する] メニュー</h3>
<p>
選んだ人物から始めて、右・下のつながりをたどってたどり着く人たちを、まとめて右に移動します。
移動量は指定できます。
</p>

<h3 class="man" id="menu_4_6">(4-6) [まとめて左に移動する] メニュー</h3>
<p>
選んだ人物から始めて、左・下のつながりをたどってたどり着く人たちを、まとめて左に移動します。
移動量は指定できます。
</p>

<h2 class="man" id="menu_5">(5) [全体] メニュー</h2>
<p>
系図の個々の部分ではなく全体に関するいくつかのメニューがあります。
</p>

<h3 class="man" id="menu_5_1">(5-1) [全体をずらす] メニュー</h3>
<p>
余白の調整などのために系図全体を上下左右に動かしたいときに使います。
動かし過ぎたと思ったら、逆方向へ動かしてみてください。
</p>

<h3 class="man" id="menu_5_2">(5-2) [全体の高さを変える] メニュー</h3>
<p>
系図全体の高さを増やしたい場合や、(系図全体の高さを減らすことで) 下の余白を減らしたい場合に使います。
上の余白を減らしたい場合は、<a href="#menu_5_1">[全体をずらす] メニュー</a>で全体を上にずらしてください。
</p>

<h3 class="man" id="menu_5_3">(5-3) [全体の幅を変える] メニュー</h3>
<p>
系図全体の幅を増やしたい場合や、(系図全体の幅を減らすことで) 右の余白を減らしたい場合に使います。
左の余白を減らしたい場合は、<a href="#menu_5_1">[全体をずらす] メニュー</a>で全体を左にずらしてください。
</p>

<h3 class="man" id="menu_5_4">(5-4) [タイトルを変更する] メニュー</h3>
<p>
出来上がった系図の SVG ファイルの中に系図のタイトルを埋め込んでおくと、ブラウザで系図を表示したときにそのタイトルがツールチップとして表示されるでしょうし、スクリーンリーダ利用時にもそのタイトルを読み上げてもらえる可能性があります。
このメニューは、そのタイトルを入力するためのものです。
タイトルの初期値は空文字列です。
</p>

<h3 class="man" id="menu_5_5">(5-5) [説明文を変更する] メニュー</h3>
<p>
出来上がった系図の SVG ファイルの中に系図の説明文を埋め込んでおくと、スクリーンリーダ利用時にその説明文を読み上げてもらえる可能性があります (ただし説明文自体は画面には表示されません)。
このメニューは、その説明文を入力するためのものです。
説明文の初期値は空文字列です。
系図の用途によっては、アクセシビリティ向上のために説明文を埋め込むことも検討してみてください。
</p>

<h2 class="man" id="menu_6">(6) [出力] メニュー</h2>
<p>
<a href="#menu_6_2">[現状のファイルをダウンロードする]</a> メニューで SVG ファイルをダウンロードすれば十分なことが多いかと思います。
やり直し (undo) 機能がないので、代わりに、<a href="#menu_6_3">[作業の各段階のファイルをダウンロードする] メニュー</a>を用意してあります。
<a href="#menu_6_5">[系図ビューワをダウンロードする] メニュー</a>では、作成した系図の簡易ビューワを構成するファイル群をまとめてダウンロードできます。
他にもちょっとした出力機能があります。
</p>

<h3 class="man" id="menu_6_1">(6-1) [SVG コードを見る] メニュー</h3>
<p>
デバッグ用に作ったようなメニューなので、通常は使う必要がないと思います。
</p>

<h3 class="man" id="menu_6_2">(6-2) [現状のファイルをダウンロードする] メニュー</h3>
<p>
<em>現状の系図のデータを SVG ファイルとしてダウンロードできます</em>。
ファイル名の接頭辞を指定できます。
</p>

<p>
また、カスタムデータ属性を残すか削除するかも指定できます。
<em>ダウンロードしたファイルを再び本ツールで開いて系図を編集したい場合には、カスタムデータ属性を残しておいてください</em>。
系図が完成して、もう本ツールでその系図を開くつもりがなく、他のアプリでその SVG
 ファイルを利用するために少しでもファイルサイズを小さくしたい場合にのみ、カスタムデータ属性を削除してください。
</p>

<p>
ダウンロードした SVG ファイルは、ブラウザで閲覧できます。
編集中と同じスタイル (色や線の幅など) で閲覧するために、ダウンロードした SVG ファイルと同じフォルダに、<a href="pedigree_svg.css">SVG 用のスタイルシートファイル</a>を置いてください。
</p>

<h3 class="man" id="menu_6_3">(6-3) [作業の各段階のファイルをダウンロードする] メニュー</h3>
<p>
<a href="#menu_4">前述のとおり</a>、<em>やり直し (undo) 機能はありません</em>。
その代わり、<em>作業の各段階のデータを SVG ファイルとしてダウンロードできる</em>ようにしてあります。
</p>

<p>
なお、<a href="#menu_6_2">[現状のファイルをダウンロードする]</a> メニューの接頭辞入力欄の文字列を、ファイル名の接頭辞として利用しています。
</p>


<p>
ダウンロードした SVG ファイルは、ブラウザで閲覧できます。
編集中と同じスタイル (色や線の幅など) で閲覧するために、ダウンロードした SVG ファイルと同じフォルダに、<a href="pedigree_svg.css">SVG 用のスタイルシートファイル</a>を置いてください。
</p>

<h3 class="man" id="menu_6_4">(6-4) [人物一覧を出力する] メニュー</h3>
<p>
あまり使い道がないかもしれませんが、系図内の人物一覧をテキストファイルとしてダウンロードできます。
<a href="#menu_1_5">[注釈の行を追加する] </a> メニューを用いて付加した注釈行の内容も出力するかどうかを選べます。
</p>

<h3 class="man" id="menu_6_5">(6-5) [系図ビューワをダウンロードする] メニュー</h3>
<p>
以下の六つのファイルを同じディレクトリに置いて、HTML ファイルをブラウザで開くと、簡易的な系図ビューワとして使えます。
</p>

<ul>
<li>系図の SVG ファイルは、<code>pedigree_viewer_<i>yyyy-mm-dd_hhmmss.sss</i>.svg</code> のようなファイル名でダウンロードされます。</li>
<li>ビューワ本体の HTML ファイルは、<code>pedigree_viewer_<i>yyyy-mm-dd_hhmmss.sss</i>.html</code> のようなファイル名でダウンロードされます。</li>
<li>ビューワの動作に必要なデータ定義を含む JavaScript ファイルは、<code>pedigree_viewer_<i>yyyy-mm-dd_hhmmss.sss</i>.js</code> のようなファイル名でダウンロードされます。</li>
<li>系図の SVG ファイル用の共通 CSS ファイル (<a href="pedigree_svg.css"><code>pedigree_svg.css</code></a>) を手動でダウンロードしてください。</li>
<li>ビューワ本体の HTML ファイル用の共通 CSS ファイル (<a href="pedigree_viewer.css"><code>pedigree_viewer.css</code></a>) を手動でダウンロードしてください。</li>
<li>ビューワの動作に必要な共通 JavaScript ファイル (<a href="pedigree_viewer.js"><code>pedigree_viewer.css</code></a>) を手動でダウンロードしてください。</li>
</ul>

<p>
系図を眺めるだけならこのままでも使えますが、<a href="#edit_2">ビューワ本体の HTML ファイルを編集して</a>、系図中の人物、横の関係、縦の関係について情報を書き加えると、ビューワをさらに便利にできます。
</p>

<p>
ビューワは、<code>?pid=p123</code> のようなクエリ文字列付きで呼び出された場合に、指定された人物 (この例では ID が <code>p123</code> の人物) の詳細情報を表示し、かつ、その人物を中心に表示するようになっています (クエリ文字列がない場合は、一番若い ID (大抵は <code>p0</code>) の人物を指定人物と見なします)。
任意の他の HTML ファイルからビューワにリンクするときに、リンク先を
<code>pedigree_viewer_<i>yyyy-mm-dd_hhmmss.sss</i>.html<i>?pid=p123</i></code>
のように指定すると便利です。
</p>

<h2 class="man" id="menu_7">(7) [読み取り] メニュー</h2>
<p>
作成済みのデータを読み込むためのメニューです。
</p>

<h3 class="man" id="menu_7_1">(7-1) [作成済みのデータを読み込む] メニュー</h3>
<p>
<a href="#menu_6_2">[現状のファイルをダウンロードする]</a> メニューまたは <a href="#menu_6_3">[作業の各段階のファイルをダウンロードする]</a> メニューまたは <a href="#menu_6_5">[系図ビューワをダウンロードする]</a> メニューで保存した SVG ファイルを読み込むことができます。
SVG ファイルを読み込んだ後は、好きなように編集できます。編集が済んだら、適宜また SVG ファイルを保存してください。
</p>

<h3 class="man" id="menu_7_2">(7-2) [自動保存したデータを読み込む] メニュー</h3>
<p>
系図の編集中に、(ブラウザの [戻る] ボタンをタップしてしまったとかで) うっかり別のページに行ってしまったり、うっかりリロードしてしまったり、うっかりタブを閉じてしまったり、ということがなきにしもあらず。
その場合、系図が残っていれば幸いで、データが消えていることもあります (多分、ブラウザの設定によります)。
そういうデータ消滅の救済策となるかもしれないメニューです。
が、[表示する] ボタンを押してデータを復活できるかどうかは、ブラウザの設定によりますので、あまり頼りになさいませぬよう。
</p>

<h2 class="man" id="edit">(8) 保存済みデータに対する手作業での編集</h2>
<p>
テキストエディタでちょちょっとファイルを編集すれば、系図の見た目をお好みのものに変えられます。
また、簡易ビューワに説明文を書き足すと、より便利なビューワになるかもしれません。
</p>

<h3 class="man" id="edit_1">(8-1) 系図の SVG ファイルを編集する</h3>
<p>
<em>スタイルを変更したいとき、あるいは、間違って追加したバッジや注釈を削除したいとき</em>は、手作業で SVG ファイルを編集してください。
SVG ファイルの実体はテキストファイルなので、テキストエディタで編集できます。
</p>

<p>
系図の SVG ファイルの冒頭付近に、以下のような <code>style</code> 要素があります。
ここを編集することで、スタイルを変更できます。
</p>

<code class="multiline">&lt;style&gt; @import url(pedigree_svg.css); &lt;/style&gt;
</code>

<p>
たとえば、皇帝用のスタイルを以下のように定義することも可能です。
この場合、<em>このスタイルを適用したい人物に相当する <code>rect</code> 要素の <code>class</code> 属性</em>に (<code>neutral</code>、<code>feminine</code>、または <code>masculine</code> の代わりに) <code>emperor</code> を指定します。
</p>

<code class="multiline">&lt;style&gt;
  @import url(pedigree_svg.css);
  <em>rect.emperor {
    stroke: hsl(255, 100%, 50%); 
    fill: hsla(255, 100%, 70%, 0.5);
  }</em>
&lt;/style&gt;
</code>

<p>
あるいは、このような独自のスタイル定義を、<a href="pedigree_svg.css"><code>pedigree_svg.css</code></a> に追加するのでも構いません (その場合は、SVG ファイルでは <code>class</code> 属性を編集するだけでよく、<code>style</code> 要素を編集する必要はありません。
</p>

<p>
あるいは、新たな別の CSS ファイルでこのような独自のスタイルを定義することも考えられます。
たとえば、その新たな CSS ファイルの名前が <code>user_defined.css</code> であれば、SVG ファイルの<code>style</code> 要素を以下のように編集します
(<code>rect</code> 要素の <code>class</code> 属性も適宜編集してください)。
</p>

<code class="multiline">&lt;style&gt;
  @import url(pedigree_svg.css);
  <em>@import url(user_defined.css);</em>
&lt;/style&gt;
</code>

<p>
<em>間違った注釈を追加してしまった場合</em>は、その注釈に該当する <code>text</code> 要素を削除してください。
注釈の <code>text</code> 要素の例を以下に示します。
</p>

<code class="multiline">  &lt;text writing-mode=&quot;tb&quot; id=&quot;p22n0&quot; x=&quot;10332&quot; y=&quot;1512&quot; textLength=&quot;48&quot; lengthAdjust=&quot;spacing&quot; dx=&quot;8&quot; dy=&quot;0&quot; class=&quot;note blue&quot;&gt;梁武帝&lt;/text&gt;
</code>

<p>
<em>間違ったバッジを追加してしまった場合</em>は、そのバッジに該当する <code>circle</code> 要素と <code>text</code> 要素のペアを削除してください。
そうしたペアの例を以下に示します。
</p>

<code class="multiline">  &lt;circle id=&quot;p2b_upper_right&quot; cx=&quot;1722&quot; cy=&quot;282&quot; r=&quot;17&quot; fill=&quot;darkblue&quot;&gt;&lt;/circle&gt;
  &lt;text id=&quot;p2bn_upper_right&quot; x=&quot;1710&quot; y=&quot;290&quot; textLength=&quot;8&quot; dx=&quot;8&quot; dy=&quot;0&quot; class=&quot;num_badge&quot;&gt;1&lt;/text&gt;
</code>

<p>
<code>circle</code> 要素の <code>fill</code> 属性の値を書き換えると、<em>バッジの色を変更できます</em>。
色指定の仕方は、<a href="https://developer.mozilla.org/ja/docs/Web/CSS/color_value">&lt;color&gt; データ型の説明ページ</a>などが参考になります。
</p>

<p>
横線に関しては破線の選択肢を用意していませんが、<em>横線を描く <code>path</code> 要素で <code>class=&quot;double dashed&quot;</code> のように <code>dashed</code> という値を追記すれば</em>、横線を破線にできます (この例は二重線ですが、一重線でも同様です)。
</p>

<h3 class="man" id="edit_2">(8-2) ビューワの HTML ファイルを編集する</h3>
<p>
<a href="#menu_6_5">系図の簡易ビューワ</a>を構成するファイルのうち、HTML ファイルを適宜編集しておくと、個々の人物に関する説明と系図を同時に見られて便利です。
具体的には以下の通りです。
</p>

<p>
下記の段落 (<code>p</code> 要素の中身) を書き換えて、系図についての全般的な説明などを書いておくようにすると便利です。
</p>

<code class="multiline">&lt;div id=&quot;info_all&quot;&gt;
&lt;p&gt;<em>この段落は、お好きなように編集してください。</em>&lt;/p&gt;
</code>

<p>
また、この <code>p</code> 要素の下には <code>dl</code> 要素があり、その中には、 <code>dt</code> 要素と <code>dd</code> 要素のペアが並んでいます。
各ペアは、ある一人の人物か、ある横リンク (婚姻関係) か、ある縦リンク (親子関係) に対応します。
その人物・横リンク・縦リンクについての情報を <code>dd</code> 要素の中に書き留めておくと便利です。
たとえば以下の例のイタリック体の部分のように、任意のメモやリンクを埋め込めます。
</p>

<code class="multiline">&lt;dt id=&quot;p162_t&quot;&gt;司馬懿&lt;/dt&gt;
&lt;dd id=&quot;p162_d&quot;&gt;
  &lt;button type=&quot;button&quot; onclick=&quot;look_at('p162')&quot;&gt;司馬懿を見る&lt;/button&gt;
  &lt;button type=&quot;button&quot; onclick=&quot;reselect('p162')&quot;&gt;司馬懿を選択する&lt;/button&gt;
<em>  179年 〜 251年。字は仲達。
  &lt;a href=&quot;https://ja.wikipedia.org/wiki/%E5%8F%B8%E9%A6%AC%E6%87%BF&quot;&gt;Wikipedia&lt;/a&gt; |
  &lt;a href=&quot;https://zh.wikisource.org/wiki/%E6%99%89%E6%9B%B8/%E5%8D%B7001&quot;&gt;『晋書』宣帝紀&lt;/a&gt;</em>
&lt;/dd&gt;
</code>

<h3 class="man" id="edit_3">(8-3) SVG 用の CSS ファイルを編集する</h3>
<p>
SVG 用の CSS ファイル (<a href="pedigree_svg.css"><code>pedigree_svg.css</code></a>) の <code>fill</code> プロパティ (矩形の背景色、文字色) や <code>stroke</code> プロパティ (矩形の枠線の色、縦線や横線の色) をお好きなように書き換えてください。
色指定の仕方は、<a href="https://developer.mozilla.org/ja/docs/Web/CSS/color_value">&lt;color&gt; データ型の説明ページ</a>などが参考になります。
</p>

<p>
お好みのフォントを使うように <code>font-family</code> プロパティを書き換えるのも良いかもしれません。
</p>

<p>
また、破線用の <code>stroke-dasharray</code> の設定を書き換えれば、一点鎖線にしたり細かい点線にしたりできます。
指定方法は、<a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dasharray">stroke-dasharray の説明ページ</a>が参考になります。
</p>

<p>
もちろん、独自のクラスを新たに定義することもできます。
たとえば、(<code>rect</code> 要素に関する) 皇帝用のクラスや、(<code>path</code> 要素に関する) ある特定の家系用のクラスを定義するのも良いかもしれません。
</p>

<h3 class="man" id="edit_4">(8-4) HTML 用の CSS ファイルを編集する</h3>
<p>
<a href="#menu_6_5">系図の簡易ビューワ</a>を構成するファイルのうち、HTML 用の CSS ファイル (<a href="pedigree_viewer.css"><code>pedigree_viewer.css</code></a>) を編集すると、ビューワの雰囲気を変えられます。
<code>color</code>, <code>background</code>, <code>border-color</code>, <code>font-family</code> あたりのプロパティをお好みに応じて書き換えてみてください。
色指定の仕方は、<a href="https://developer.mozilla.org/ja/docs/Web/CSS/color_value">&lt;color&gt; データ型の説明ページ</a>などが参考になります。
</p>


</div>
</body>
</html>

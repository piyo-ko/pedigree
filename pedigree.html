<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="pedigree.css" type="text/css">
<script type="text/javascript" src="mode_setting.js"></script>
<script type="text/javascript" src="pedigree.js"></script>
<base target="_top">
<title>系図を描いて SVG データにしてみよう</title>
</head>
<body>

<h1>系図を描いて SVG データにしてみよう</h1>

<div id="tree_canvas_div">
<svg id="pedigree" xmlns="http://www.w3.org/2000/svg" width="600" height="300" viewBox="0 0 600 300">
<style><![CDATA[ @import url(pedigree_svg.css); ]]></style>
</svg>
</div>

<p class="info">
ポインタの位置にある人物は、
ID が <span id="info_pid" class="info">&nbsp;</span> で、
名前が <span id="info_name" class="info">&nbsp;</span> で、
X 座標の範囲が <span class="info">[<span id="info_x_start"></span>, <span id="info_x_end"></span>]</span> で、
その中心が <span id="info_x_mid" class="info">&nbsp;</span> で、
Y 座標の範囲が <span class="info">[<span id="info_y_start"></span>, <span id="info_y_end"></span>]</span> です。
</p>

<p class="btn" role="menu">
<span class="btn" role="menuitem" onclick="show_menu('menu_person')">人物の追加・拡大・注釈追加</span>
<span class="btn" role="menuitem" onclick="show_menu('menu_hlink')">横の関係の追加・削除</span>
<span class="btn" role="menuitem" onclick="show_menu('menu_vlink')">縦の関係の追加・削除</span>
<span class="btn" role="menuitem" onclick="show_menu('menu_move_person')">人物の移動</span>
<span class="btn" role="menuitem" onclick="show_menu('menu_shift_all')">全体の移動</span>
<span class="btn" role="menuitem" onclick="show_menu('menu_whole_size')">全体の大きさの調整</span>
<span class="btn" role="menuitem" onclick="show_menu('menu_output')">出力</span>
<span class="btn" role="menuitem" onclick="show_menu('menu_read')">読み取り</span>
</p>

<form name="menu">
<table id="menu_table">
<tr class="menu_person">
<th>人を<wbr>追加する</th>
<td>
名前 <input type="text" name="new_personal_name" size="10"> を入力。

<input type="checkbox" name="verticalize" id="verticalize"> 
<label for="verticalize">名前を縦書きにする場合</label>はチェック。

スタイルは
<input type="radio" name="new_personal_gender" value="neutral" checked id="new_personal_gender_neutral">
<label for="new_personal_gender_neutral">なし</label>

<input type="radio" name="new_personal_gender" value="feminine" id="new_personal_gender_feminine">
<label for="new_personal_gender_feminine">女性</label>

<input type="radio" name="new_personal_gender" value="masculine" id="new_personal_gender_masculine">
<label for="new_personal_gender_masculine">男性</label>。
<br>
配置先は、
<input type="radio" name="position" value="random" id="position_random" checked>
<label for="position_random">ランダム</label>、あるいは、
<select id="position_ref" name="position_ref"></select>
を基準としてその
<input type="radio" name="position" value="upper_left" id="position_upper_left">
<label for="position_upper_left">左上</label>
<input type="radio" name="position" value="upper_center" id="position_upper_center">
<label for="position_upper_center">真上</label>
<input type="radio" name="position" value="upper_right" id="position_upper_right">
<label for="position_upper_right">右上</label>
<input type="radio" name="position" value="left" id="position_left">
<label for="position_left">左</label>
<input type="radio" name="position" value="right" id="position_right">
<label for="position_right">右</label>
<input type="radio" name="position" value="lower_left" id="position_lower_left">
<label for="position_lower_left">左下</label>
<input type="radio" name="position" value="lower_center" id="position_lower_center">
<label for="position_lower_center">真下</label>
<input type="radio" name="position" value="lower_right" id="position_lower_right">
<label for="position_lower_right">右下</label>。
<input type="button" value="この人を追加する" onclick="add_person()">
</td>
</tr>

<tr class="menu_person">
<th>名前を<wbr>修正する</th>
<td>
<select id="person_to_rename" name="person_to_rename"></select> の名前を
<input type="text" name="renamed_as" size="10"> に
<input type="button" value="変更する" onclick="rename_person()">。
<br>
<input type="checkbox" id="shrink_rect_if_name_shortened" name="shrink_rect_if_name_shortened">
<label for="shrink_rect_if_name_shortened">名前が短くなる場合には、それに合わせて矩形も縮小する。</label>
</td>
</tr>

<tr class="menu_person">
<th>矩形の高さを<wbr>増やす</th>
<td>
<select id="person_to_be_extended" name="person_to_be_extended"></select>
を表す矩形の高さを
<input type="button" value="増やす" onclick="extend_rect()">。
</td>
</tr>

<tr class="menu_person">
<th>注釈の行を<wbr>追加する</th>
<td>
<select id="annotation_target" name="annotation_target"></select>
に対して、
<input type="text" name="annotation_txt" size="20">
という注釈の行を
<input type="button" value="追加する" onclick="annotate()">。
</td>
</tr>

<tr class="menu_hlink">
<th>横の関係を<wbr>追加する</th>
<td>
<select id="partner_1" name="partner_1"></select> と
<select id="partner_2" name="partner_2"></select> の間を

<input type="radio" name="horizontal_link_type" value="single" id="horizontal_link_type_single">
<label for="horizontal_link_type_single">一重線</label>

<input type="radio" name="horizontal_link_type" value="double" checked id="horizontal_link_type_double">
<label for="horizontal_link_type_double">二重線</label>

で <input type="button" value="結ぶ" onclick="add_h_link()">。
</td>
</tr>

<tr class="menu_hlink">
<th>詳細を指定して<wbr>横の関係を<wbr>追加する</th>
<td>
<select id="lhs_person" name="lhs_person" onchange="lhs_set_choices()">
<option value="dummy" selected>左側の人物</option>
</select>
の右辺上の位置 (上から
<select id="lhs_person_right_edge" name="lhs_person_right_edge"></select>
の所) と、
<select id="rhs_person" name="rhs_person" onchange="rhs_set_choices()">
<option value="dummy" selected>右側の人物</option>
</select>
の左辺上の位置 (上から
<select id="rhs_person_left_edge" name="rhs_person_left_edge"></select>
の所) を指定して (使用済みの箇所は選択不可になっています)、その間を
<input type="radio" name="horizontal_link_type2" value="single" id="horizontal_link_type2_single">
<label for="horizontal_link_type2_single">一重線</label>
<input type="radio" name="horizontal_link_type2" value="double" checked id="horizontal_link_type2_double">
<label for="horizontal_link_type2_double">二重線</label>
で <input type="button" value="結ぶ" onclick="add_h_link_2()">。
</td>
</tr>

<tr class="menu_hlink">
<th>横の関係を<wbr>削除する</th>
<td>
<select id="hlink_to_remove"></select> の間の関係を
<input type="button" value="削除する" onclick="remove_h_link()">。
</td>
</tr>

<tr class="menu_vlink">
<th>縦の関係を<wbr>追加する</th>
<td>
親 (祖先) <select id="parent_1" name="parent_1"></select> と
子 (子孫) <select id="child_1" name="child_1"></select> を

<input type="radio" name="vertical_link1_type" value="solid" checked id="vertical_link1_type_solid">
<label for="vertical_link1_type_solid">実線</label>

<input type="radio" name="vertical_link1_type" value="dashed" id="vertical_link1_type_dashed">
<label for="vertical_link1_type_dashed">破線</label>

で <input type="button" value="結ぶ" onclick="add_v_link_1()">。

<br>
あるいは、<!--既に横線で結ばれている二人-->
<select id="parents_2" name="parents_2"></select> を結ぶ横線と
<select id="child_2" name="child_2"></select> を

<input type="radio" name="vertical_link2_type" value="solid" checked id="vertical_link2_type_solid">
<label for="vertical_link2_type_solid">実線</label>

<input type="radio" name="vertical_link2_type" value="dashed" id="vertical_link2_type_dashed">
<label for="vertical_link2_type_dashed">破線</label>

で <input type="button" value="結ぶ" onclick="add_v_link_2()">。
</td>
</tr>


<tr class="menu_vlink">
<th>縦の関係を<wbr>削除する</th>
<td>
<select id="vlink_to_remove"></select> の縦の関係を
<input type="button" value="削除する" onclick="remove_v_link()">。
</td>
</tr>

<tr class="menu_move_person">
<th>人の位置を<wbr>動かす</th>
<td>
<select id="target_person" name="target_person"></select> を

<input type="radio" name="moving_direction" value="up" checked id="moving_direction_up">
<label for="moving_direction_up">上</label>

<input type="radio" name="moving_direction" value="down" id="moving_direction_down">
<label for="moving_direction_down">下</label>

<input type="radio" name="moving_direction" value="left" id="moving_direction_left">
<label for="moving_direction_left">左</label>

<input type="radio" name="moving_direction" value="right" id="moving_direction_right">
<label for="moving_direction_right">右</label>

に <input type="text" name="how_much_moved" size="3"> px だけ
<input type="button" value="動かす" onclick="move_person()">。
</td>
</tr>

<tr class="menu_move_person">
<th>人の位置を<wbr>揃える</th>
<td>
<select id="ref_person" name="ref_person"></select> を基準にして、
<select id="alignment_type" name="alignment_type">
<option value="h_align_left">左揃え</option>
<option value="h_align_center" selected>左右中央揃え</option>
<option value="h_align_right">右揃え</option>
<option value="v_align_top">上揃え</option>
<option value="v_align_middle">上下中央揃え</option>
<option value="v_align_bottom">下揃え</option>
</select>
になるように、
<select id="person_to_align" name="person_to_align"></select> を
<input type="button" value="動かす" onclick="align_person()">。
</td>
</tr>

<tr class="menu_move_person">
<th>子孫も<wbr>まとめて<wbr>下に移動する</th>
<td>
<select id="person_to_move_down" name="person_to_move_down"></select> を、その子孫も一緒にまとめて下に <input type="text" name="how_much_moved_down" size="3"> px だけ
<input type="button" value="動かす" onclick="move_down_person_and_descendants()">。
</td>
</tr>

<tr class="menu_move_person">
<th>まとめて右に<wbr>移動する</th>
<td>
<select id="person_to_move_right" name="person_to_move_right"></select>
から始めて、右・下のつながりをたどってたどり着く人たちをまとめて右に
<input type="text" name="how_much_moved_right" size="3"> px だけ
<input type="button" value="動かす" onclick="move_right_collectively()">。
</td>
</tr>

<tr class="menu_shift_all">
<th>全体を<wbr>ずらす</th>
<td>
全体を

<input type="radio" name="shift_direction" value="up" checked id="shift_direction_up">
<label for="shift_direction_up">上</label>

<input type="radio" name="shift_direction" value="down" id="shift_direction_down">
<label for="shift_direction_down">下</label>

<input type="radio" name="shift_direction" value="left" id="shift_direction_left">
<label for="shift_direction_left">左</label>

<input type="radio" name="shift_direction" value="right" id="shift_direction_right">
<label for="shift_direction_right">右</label>

に <input type="text" name="how_much_shifted" size="3"> px だけ
<input type="button" value="動かす" onclick="shift_all()">。
</td>
</tr>

<tr class="menu_whole_size">
<th>全体の<wbr>高さを<wbr>変える</th>
<td>
現状の高さは <span id="current_height"></span> px。
これを <input type="text" name="height_diff" size="3"> px 
<input type="button" value="増やす" onclick="modify_height()">
(減らす場合は負数を指定)。
</td>
</tr>

<tr class="menu_whole_size">
<th>全体の幅を<wbr>変える</th>
<td>
現状の幅は <span id="current_width"></span> px。
これを <input type="text" name="width_diff" size="3"> px 
<input type="button" value="増やす" onclick="modify_width()">
(減らす場合は負数を指定)。
</td>
</tr>

<tr class="menu_output">
<th>SVG コードを<wbr>見る</th>
<td>
現状の図について<input type="button" value="以下の枠内に出力する" onclick="output_svg_src()"><br>
<code id="svg_code"></code>
</td>
</tr>

<tr class="menu_output">
<th>現状の<wbr>ファイルを<wbr>ダウンロードする</th>
<td>
現状の図について SVG 形式のファイルを<input type="button" value="ダウンロードする" onclick="download_svg()">
(ファイル名の接頭辞: <input type="text" size="10" name="filename_prefix" value="pedigree" onchange="set_prefix()"/>)。
<br>
なお、ダウンロードした SVG ファイルと同じフォルダに、<a href="pedigree_svg.css" download="pedigree_svg.css">このスタイルシートファイル</a>を置いてください。
</td>
</tr>

<tr class="menu_output">
<th>作業の各段階の<wbr>ファイルを<wbr>ダウンロードする</th>
<td>作業の各段階での SVG ファイル (ファイル名の接頭辞は上の入力欄のものを使います): <ul id="svg_backup"></ul></td>
</tr>

<tr class="menu_read">
<th>作成済みの<wbr>データを<wbr>読み込む</th>
<td>SVG ファイルを選択して 
(<input type="file" id="input_svg_file" name="input_svg_file" />)、
その内容を上の枠内に
<input type="button" value="表示する" onclick="read_in()">。
</td>
</tr>

</table>
</form>

<nav>[
<a href="https://piyo-ko.github.io">ホーム</a> |
バグなどを<a href="https://twitter.com/share?text=@pi__yo__ko%20" target="_blank">Twitter で連絡する</a> |
<a href="https://piyo-ko.github.io/tools/svg2png.html">PNG 形式への変換</a> (SVG 形式で一旦データを保存しないと変換できません) |
<a href="https://github.com/piyo-ko/pedigree">このページに関する説明</a>
]</nav>
</body>
</html>

<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="pedigree.css" type="text/css">
<script type="text/javascript" src="mode_setting.js"></script>
<script type="text/javascript" src="common.js"></script>
<script type="text/javascript" src="pedigree.js"></script>
<meta name="keywords" content="系図,家系図,Scalable Vector Graphics,SVG,描画ツール">
<base target="_top">
<title>系図を描いて SVG データにしてみよう</title>
</head>
<body>

<h1>系図を描いて SVG データにしてみよう</h1>

<div id="tree_canvas_div">
<svg id="pedigree" xmlns="http://www.w3.org/2000/svg" width="600" height="300" viewBox="0 0 600 300" role="img" aria-labelledby="chart_description">
<title id="chart_title"></title>
<desc id="chart_description"></desc>
<style><![CDATA[ @import url(pedigree_svg.css); ]]></style>
</svg>
</div>

<p class="info">
ポインタの位置にある人物は、
ID が <span id="info_pid" class="info"></span> で、
名前が <span id="info_name" class="info"></span> で、
X 座標の範囲が <span class="info">[<span id="info_x_start"></span>, <span id="info_x_end"></span>]</span> で、
その中心が <span id="info_x_mid" class="info">&nbsp;</span> で、
Y 座標の範囲が <span class="info">[<span id="info_y_start"></span>, <span id="info_y_end"></span>]</span> です。
<input type="button" value="縦横の関係の詳細" onclick="show_detailed_info_about_links()">
</p>

<div id="detailed_info_about_links"></div>

<form name="menu">
<p class="btn" role="menu">
<button class="menu" type="button" onclick="show_menu('menu_person')">個々の人物</button>
<button class="menu" type="button" onclick="show_menu('menu_hlink')">横の関係</button>
<button class="menu" type="button" onclick="show_menu('menu_vlink')">縦の関係</button>
<button class="menu" type="button" onclick="show_menu('menu_move_person')">人物の移動</button>
<button class="menu" type="button" onclick="show_menu('menu_whole')">全体</button>
<button class="menu" type="button" onclick="show_menu('menu_output')">出力</button>
<button class="menu" type="button" onclick="show_menu('menu_read')">読み取り</button>
</p>

<table id="menu_table">

<tr class="menu_person">
<th>文字の幅</th>
<td>
<label for="character_spacing_mode_wide_mode">
<input type="radio" name="character_spacing_mode" id="character_spacing_mode_wide_mode" value="wide_mode" checked>
幅広モード (漢字・仮名向け)
</label>
<label for="character_spacing_mode_narrow_mode">
<input type="radio" name="character_spacing_mode" id="character_spacing_mode_narrow_mode" value="narrow_mode">
幅狭モード (ラテン文字向け)
</label>
</td>
</tr>

<tr class="menu_person">
<th>人を<wbr>追加する</th>
<td>
<label for="new_personal_name">名前 <input type="text" name="new_personal_name" id="new_personal_name" size="10"> を入力。</label>

<label for="verticalize">
<input type="checkbox" name="verticalize" id="verticalize"> 
名前を縦書きにする場合</label>はチェック。

スタイルは
<label for="new_personal_gender_neutral">
<input type="radio" name="new_personal_gender" value="neutral" checked id="new_personal_gender_neutral">
なし</label>

<label for="new_personal_gender_feminine">
<input type="radio" name="new_personal_gender" value="feminine" id="new_personal_gender_feminine">
女性</label>

<label for="new_personal_gender_masculine">
<input type="radio" name="new_personal_gender" value="masculine" id="new_personal_gender_masculine">
男性</label>。
<br>
配置先は、
<label for="position_random">
<input type="radio" name="position" value="random" id="position_random" checked>
ランダム</label>、あるいは、
<select id="position_ref" name="position_ref"></select>
を<label for="position_ref">基準として</label>その
<label for="position_upper_left">
<input type="radio" name="position" value="upper_left" id="position_upper_left">
左上</label>
<label for="position_upper_center">
<input type="radio" name="position" value="upper_center" id="position_upper_center">
真上</label>
<label for="position_upper_right">
<input type="radio" name="position" value="upper_right" id="position_upper_right">
右上</label>
<label for="position_left">
<input type="radio" name="position" value="left" id="position_left">
左</label>
<label for="position_right">
<input type="radio" name="position" value="right" id="position_right">
右</label>
<label for="position_lower_left">
<input type="radio" name="position" value="lower_left" id="position_lower_left">
左下</label>
<label for="position_lower_center">
<input type="radio" name="position" value="lower_center" id="position_lower_center">
真下</label>
<label for="position_lower_right">
<input type="radio" name="position" value="lower_right" id="position_lower_right">
右下</label>。
<input type="button" value="この人を追加する" onclick="add_person()">
</td>
</tr>

<tr class="menu_person">
<th>名前を<wbr>修正する</th>
<td>
<select id="person_to_rename" name="person_to_rename"></select> の名前を
<input type="text" name="renamed_as" size="10"> に
<input type="button" value="変更する" onclick="rename_person()">。
<br>
<label for="shrink_rect_if_name_shortened">
<input type="checkbox" id="shrink_rect_if_name_shortened" name="shrink_rect_if_name_shortened">
名前が短くなる場合には、それに合わせて矩形も縮小する。</label>
</td>
</tr>

<tr class="menu_person">
<th>矩形の高さを<wbr>増やす</th>
<td>
<select id="person_to_be_extended" name="person_to_be_extended"></select>
を表す矩形の高さを
<input type="button" value="増やす" onclick="extend_rect()">。
</td>
</tr>

<tr class="menu_person">
<th>注釈の行を<wbr>追加する</th>
<td>
<select id="annotation_target" name="annotation_target"></select>
に対して、
<input type="text" name="annotation_txt" id="annotation_txt" size="20">
という<label for="annotation_txt">注釈の行</label>
(<label for="note_color">注釈の色は
<select id="note_color" name="note_color">
<option value="blue" selected>青</option>
<option value="sage_green">青緑</option>
<option value="green">緑</option>
<option value="orange">橙</option>
<option value="red">赤</option>
<option value="purple">赤紫</option>
</select>
</label>
)
を
<input type="button" value="追加する" onclick="annotate()">。
<br>
色見本:
<span class="note_color blue">■</span>
<span class="note_color sage_green">■</span>
<span class="note_color green">■</span>
<span class="note_color orange">■</span>
<span class="note_color red">■</span>
<span class="note_color purple">■</span>
</td>
</tr>

<tr class="menu_person">
<th>番号の<wbr>バッジを<wbr>つける</th>
<td>
<select id="person_to_add_badge" name="person_to_add_badge"></select>
の
<label for="badge_pos_upper_left">
<input type="radio" name="badge_pos" id="badge_pos_upper_left" value="upper_left">
左上</label>
<label for="badge_pos_upper_right">
<input type="radio" name="badge_pos" id="badge_pos_upper_right" value="upper_right" checked>
右上</label>
<label for="badge_pos_lower_left">
<input type="radio" name="badge_pos" id="badge_pos_lower_left" value="lower_left">
左下</label>
<label for="badge_pos_lower_right">
<input type="radio" name="badge_pos" id="badge_pos_lower_right" value="lower_right">
右下</label>
に、
<select name="badge_color" id="badge_color">
<option value="black">黒</option>
<option value="dimgray">灰</option>
<option value="darkblue" selected>紺</option>
<option value="crimson">紅</option>
<option value="saddlebrown">茶</option>
<option value="purple">紫</option>
<option value="darkgreen">緑</option>
</select>
を背景色として、
番号<input type="text" name="badge_num" id="badge_num" size="3"> (0 以上 999 以下) の
<input type="button" value="バッジをつける" onclick="add_num_badge()">。
<br>
色見本:
<span class="badge_color black">■</span>
<span class="badge_color dimgray">■</span>
<span class="badge_color darkblue">■</span>
<span class="badge_color crimson">■</span>
<span class="badge_color saddlebrown">■</span>
<span class="badge_color purple">■</span>
<span class="badge_color darkgreen">■</span>
</td>
</tr>

<tr class="menu_person">
<th>人を<wbr>見る</th>
<td>
<select id="person_to_look_at" name="person_to_look_at" aria-label="見たい人を選んでください。"></select>
を<input type="button" value="見る" onclick="look_at_person()">。
</td>
</tr>

<tr class="menu_person">
<th>人を<wbr>削除する</th>
<td>
<select id="person_to_remove" name="person_to_remove"></select>
を<input type="button" value="削除する" onclick="remove_person()">。
</td>
</tr>

<tr class="menu_hlink">
<th>横の関係を<wbr>追加する</th>
<td>
<select id="partner_1" name="partner_1"></select> と
<select id="partner_2" name="partner_2"></select> の間を

<label for="horizontal_link_type_single">
<input type="radio" name="horizontal_link_type" value="single" id="horizontal_link_type_single">
一重線</label>

<label for="horizontal_link_type_double">
<input type="radio" name="horizontal_link_type" value="double" checked id="horizontal_link_type_double">
二重線</label>

で <input type="button" value="結ぶ" onclick="add_h_link()">。
</td>
</tr>

<tr class="menu_hlink">
<th>詳細を指定して<wbr>横の関係を<wbr>追加する</th>
<td>
<select id="lhs_person" name="lhs_person" onchange="lhs_set_choices()">
<option value="dummy" selected>左側の人物</option>
</select>
の右辺上の位置 (上から
<select id="lhs_person_right_edge" name="lhs_person_right_edge"></select>
の所) と、
<select id="rhs_person" name="rhs_person" onchange="rhs_set_choices()">
<option value="dummy" selected>右側の人物</option>
</select>
の左辺上の位置 (上から
<select id="rhs_person_left_edge" name="rhs_person_left_edge"></select>
の所) を指定して (使用済みの箇所は選択不可になっています)、その間を
<label for="horizontal_link_type2_single">
<input type="radio" name="horizontal_link_type2" value="single" id="horizontal_link_type2_single">
一重線</label>
<label for="horizontal_link_type2_double">
<input type="radio" name="horizontal_link_type2" value="double" checked id="horizontal_link_type2_double">
二重線</label>
で <input type="button" value="結ぶ" onclick="add_h_link_2()">。
</td>
</tr>

<tr class="menu_hlink">
<th>横方向に<wbr>つなぐことの可能な<wbr>相手の数を<wbr>増やす</th>
<td>
<select id="target_of_increase_of_hlinks" name="target_of_increase_of_hlinks"></select> の
<label for="target_side_lhs">
<input type="radio" name="target_side" value="lhs" id="target_side_lhs" checked>
左辺</label>
<label for="target_side_rhs">
<input type="radio" name="target_side" value="rhs" id="target_side_rhs">
右辺</label>
につなぐことの可能な相手の数を
<input type="button" value="増やす" onclick="increase_num_of_hlinks()">。
</td>
</tr>

<tr class="menu_hlink">
<th>横の関係を<wbr>削除する</th>
<td>
<select id="hlink_to_remove" name="hlink_to_remove"></select> の間の関係を
<input type="button" value="削除する" onclick="remove_h_link()">。
</td>
</tr>

<tr class="menu_vlink">
<th>縦の関係を<wbr>追加する</th>
<td>
<label for="parent_1">親 (祖先) <select id="parent_1" name="parent_1"></select></label> と
<label for="child_1">子 (子孫) <select id="child_1" name="child_1"></select></label> を

<label for="vertical_link1_type_solid">
<input type="radio" name="vertical_link1_type" value="solid" checked id="vertical_link1_type_solid">
実線</label>

<label for="vertical_link1_type_dashed">
<input type="radio" name="vertical_link1_type" value="dashed" id="vertical_link1_type_dashed">
破線</label>

で <input type="button" value="結ぶ" onclick="add_v_link_1()">。

<br>
あるいは、<!--既に横線で結ばれている二人-->
<select id="parents_2" name="parents_2"></select> を結ぶ横線と
<select id="child_2" name="child_2"></select> を

<label for="vertical_link2_type_solid">
<input type="radio" name="vertical_link2_type" value="solid" checked id="vertical_link2_type_solid">
実線</label>

<label for="vertical_link2_type_dashed">
<input type="radio" name="vertical_link2_type" value="dashed" id="vertical_link2_type_dashed">
破線</label>

で <input type="button" value="結ぶ" onclick="add_v_link_2()">。
</td>
</tr>

<tr class="menu_vlink">
<th>横線の下に<wbr>縦線を<wbr>ぶら下げる<wbr>位置を<wbr>調整する</th>
<td>
<select id="hlink_to_ajdust_its_connect_pos_x" name="hlink_to_ajdust_its_connect_pos_x" onchange="set_current_connect_pos_x()"></select> を結ぶ横線から下に向かう縦線の開始位置を調整する:
[左端付近]
<input id="connect_pos_x_range" name="connect_pos_x_range" type="range" min="0" max="100" step="0.1" oninput="apply_connect_pos_x_input()" onchange="record_connect_pos_x_adjustment()">
[右端付近]
<input type="button" value="真ん中に戻す" onclick="reset_connect_pos_x()">
</td>
</tr>

<tr class="menu_vlink">
<th>縦の関係を<wbr>削除する</th>
<td>
<select id="vlink_to_remove" name="vlink_to_remove"></select> の縦の関係を
<input type="button" value="削除する" onclick="remove_v_link()">。
</td>
</tr>

<tr class="menu_move_person">
<th>人の位置を<wbr>動かす</th>
<td>
<select id="target_person" name="target_person"></select> を

<label for="moving_direction_up">
<input type="radio" name="moving_direction" value="up" checked id="moving_direction_up">
上</label>

<label for="moving_direction_down">
<input type="radio" name="moving_direction" value="down" id="moving_direction_down">
下</label>

<label for="moving_direction_left">
<input type="radio" name="moving_direction" value="left" id="moving_direction_left">
左</label>

<label for="moving_direction_right">
<input type="radio" name="moving_direction" value="right" id="moving_direction_right">
右</label>

に <input type="text" name="how_much_moved" size="3"> px だけ
<input type="button" value="動かす" onclick="move_person()">。
</td>
</tr>

<tr class="menu_move_person">
<th>人の位置を<wbr>揃える</th>
<td>
<select id="ref_person" name="ref_person"></select> を基準にして、
<select id="alignment_type" name="alignment_type">
<option value="h_align_left">左揃え</option>
<option value="h_align_center" selected>左右中央揃え</option>
<option value="h_align_right">右揃え</option>
<option value="v_align_top">上揃え</option>
<option value="v_align_middle">上下中央揃え</option>
<option value="v_align_bottom">下揃え</option>
</select>
になるように、
<select id="person_to_align" name="person_to_align"></select> を
<input type="button" value="動かす" onclick="align_person()">。
</td>
</tr>


<tr class="menu_move_person">
<th>親または子を<wbr>基準にして<wbr>人を動かす</th>
<td>
<select id="person_to_center" name="person_to_center"></select> を、
親からの縦線がまっすぐになるように<input type="button" value="動かす" onclick="center_person_wrt_upper_link()">か、あるいは、
下辺につながっている子 (たち) の中央へ<input type="button" value="動かす" onclick="center_person_wrt_lower_links()">。
</td>
</tr>

<tr class="menu_move_person">
<th>子孫も<wbr>まとめて<wbr>下に移動する</th>
<td>
<select id="person_to_move_down" name="person_to_move_down"></select> を、その子孫も一緒にまとめて下に <input type="text" name="how_much_moved_down" size="3"> px だけ
<input type="button" value="動かす" onclick="move_down_person_and_descendants()">。
</td>
</tr>

<tr class="menu_move_person">
<th>まとめて右に<wbr>移動する</th>
<td>
<select id="person_to_move_right" name="person_to_move_right"></select>
から始めて、右・下のつながりをたどってたどり着く人たちをまとめて右に
<input type="text" name="how_much_moved_right" size="3"> px だけ
<input type="button" value="動かす" onclick="move_right_collectively()">。
</td>
</tr>

<tr class="menu_move_person">
<th>まとめて左に<wbr>移動する</th>
<td>
<select id="person_to_move_left" name="person_to_move_left"></select>
から始めて、左・下のつながりをたどってたどり着く人たちをまとめて左に
<input type="text" name="how_much_moved_left" size="3"> px だけ
<input type="button" value="動かす" onclick="move_left_collectively()">。
</td>
</tr>

<tr class="menu_whole">
<th>全体を<wbr>ずらす</th>
<td>
全体を

<label for="shift_direction_up">
<input type="radio" name="shift_direction" value="up" checked id="shift_direction_up">
上</label>

<label for="shift_direction_down">
<input type="radio" name="shift_direction" value="down" id="shift_direction_down">
下</label>

<label for="shift_direction_left">
<input type="radio" name="shift_direction" value="left" id="shift_direction_left">
左</label>

<label for="shift_direction_right">
<input type="radio" name="shift_direction" value="right" id="shift_direction_right">
右</label>

に <input type="text" name="how_much_shifted" size="3"> px だけ
<input type="button" value="動かす" onclick="shift_all()">。
</td>
</tr>

<tr class="menu_whole">
<th>全体の<wbr>高さを<wbr>変える</th>
<td>
現状の高さは <span id="current_height"></span> px。
これを <input type="text" name="height_diff" size="3"> px 
<input type="button" value="増やす" onclick="modify_height()">
(減らす場合は負数を指定)。
</td>
</tr>

<tr class="menu_whole">
<th>全体の幅を<wbr>変える</th>
<td>
現状の幅は <span id="current_width"></span> px。
これを <input type="text" name="width_diff" size="3"> px 
<input type="button" value="増やす" onclick="modify_width()">
(減らす場合は負数を指定)。
</td>
</tr>

<tr class="menu_whole">
<th>タイトルを変更する</th>
<td>
タイトルは、(環境にもよりますが) マウスホバーに応じてツールチップとして表示されます。
<br>
現在のタイトル:<br>
<code id="cur_chart_title"></code>
<br>
<label for="new_chart_title">新たなタイトル:<br>
<textarea cols="40" rows="1" name="new_chart_title" id="new_chart_title"></textarea>
</label>
<br>
<input type="button" value="新たなタイトルを設定する" onclick="modify_title()">
</td>
</tr>

<tr class="menu_whole">
<th>説明文を変更する</th>
<td>
説明文は、系図上には表示されませんが、アクセシビリティ向上のために使われます。
<br>
現在の説明文:<br>
<code id="cur_chart_desc"></code>
<br>
<label for="new_chart_desc">新たな説明文:<br>
<textarea cols="40" rows="4" name="new_chart_desc" id="new_chart_desc"></textarea>
</label>
<br>
<input type="button" value="新たな説明文を設定する" onclick="modify_description()">
</td>
</tr>

<tr class="menu_output">
<th>SVG コードを<wbr>見る</th>
<td>
現状の図について<input type="button" value="以下の枠内に出力する" onclick="output_svg_src()"><br>
<code id="svg_code"></code>
</td>
</tr>

<tr class="menu_output">
<th>現状の<wbr>ファイルを<wbr>ダウンロードする</th>
<td>
カスタムデータ属性を
<label for="delete_custom_data_attributes_yes"><input type="radio" name="delete_custom_data_attributes" value="yes" id="delete_custom_data_attributes_yes" aria-label="カスタムデータ属性を削除する (ファイルサイズを削減できますが当アプリでの再編集はできなくなります)">削除する (ファイルサイズを削減できますが当アプリでの再編集はできなくなります)</label>
<label for="delete_custom_data_attributes_no"><input type="radio" name="delete_custom_data_attributes" value="no" id="delete_custom_data_attributes_no" aria-label="カスタムデータ属性を残す" checked>残す</label>
ことにして、<br>
<label for="filename_prefix">ファイル名の接頭辞</label>を
<input type="text" size="10" name="filename_prefix" id="filename_prefix" value="pedigree" onchange="set_prefix()"/>
とし、<br>
現状の図について SVG 形式のファイルを<input type="button" value="ダウンロードする" onclick="download_svg()" aria-label="現状の図について SVG 形式のファイルをダウンロードする">。
<br>
※ ダウンロードした SVG ファイルと同じフォルダに、<a href="pedigree_svg.css" download="pedigree_svg.css">SVG 用のスタイルシートファイル</a>を置いてください。
</td>
</tr>

<tr class="menu_output">
<th>作業の各段階の<wbr>ファイルを<wbr>ダウンロードする</th>
<td>作業の各段階での SVG ファイル (ファイル名の接頭辞は上の入力欄のものを使います): <ul id="svg_backup"></ul></td>
</tr>

<tr class="menu_output">
<th>人物一覧を<wbr>出力する</th>
<td>人物一覧を名前順で<input type="button" value="テキストファイルに出力する" onclick="list_persons()">
(<label for="output_notes"><input type="checkbox" name="output_notes" id="output_notes" checked>
注釈行の内容も出力する場合</label>はチェック)。<br>
</td>
</tr>

<tr class="menu_output">
<th>系図ビューワを<wbr>ダウンロードする</th>
<td>作成した個々の系図に専用のビューワ (HTML ファイル、SVG ファイル、JavaScript ファイルを含む) をダウンロードできます。
<input type="button" value="系図ビューワをダウンロードする" onclick="download_pedigree_viewer()">
<br>
[使い方] ダウンロードした HTML ファイルの dd 要素を適宜編集してお使いください。
なお、ダウンロードしたファイルと同じフォルダに、<a href="pedigree_svg.css" download="pedigree_svg.css">SVG 用のスタイルシートファイル</a>と、<a href="pedigree_viewer.css" download="pedigree_viewer.css">HTML 用のスタイルシートファイル</a>と、<a href="pedigree_viewer.js" download="pedigree_viewer.js">JavaScript ファイル</a>を置いてください (これらは個々の系図によらない共通ファイルです)。
</td>
</tr>

<tr class="menu_read">
<th>作成済みの<wbr>データを<wbr>読み込む</th>
<td><label for="input_svg_file">SVG ファイルを選択して</label>
(<input type="file" id="input_svg_file" name="input_svg_file" />)、
その内容を上の枠内に
<input type="button" value="表示する" onclick="read_in()">。
</td>
</tr>

<tr class="menu_read">
<th>自動保存した<wbr>データを<wbr>読み込む</th>
<td>自動保存したデータがあれば、それを読み込んで
<input type="button" value="表示する" name="read_automatically_saved_data_button" onclick="read_automatically_saved_data()">。
<br>
※ データを自動保存できるかどうかは、ブラウザの設定によります。自動保存できない設定の場合、ボタンが無効化されます。
また、タブを閉じた場合、ブラウザを終了した場合に、データが消えることがあります (ブラウザの設定によります)。
このメニューは、うっかり別のページに戻ってしまったり本ページをリロードしてしまった場合のための救済策に過ぎません。
</td>
</tr>

</table>
</form>

<nav>[
<a href="manual_ja.html" target="_blank">使い方</a> | 
<a href="https://piyo-ko.github.io">ホーム</a> |
<a href="pedigree-en.html">English version</a> |
バグなどを<a href="https://twitter.com/pi__yo__ko" target="_blank">Twitter で連絡する</a> |
<a href="https://piyo-ko.github.io/tools/svg2png.html">PNG 形式への変換</a> (SVG 形式で一旦データを保存しないと変換できません) |
<a href="https://github.com/piyo-ko/pedigree">このページに関する説明</a>
]</nav>
</body>
</html>
